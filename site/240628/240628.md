# 28 June 2024

## kraken-biom attempt - vector length error
```
# create biom from kraken2 reports

cd /xdisk/kcooper/caparicio/tree-fruit/05kraken-biom_b

module load anaconda/2020

source ~/.bashrc

apptainer run https://depot.galaxyproject.org/singularity/kraken-biom:1.2.0--pyh5e36f6f_0

kraken-biom s01.report s02.report s03.report s04.report s05.report s06.report s07.report s08.report s09.report s10.report s11.report s12.report s13.report s14.report s15.report s16.report s17.report s18.report s19.report s20.report s21.report s22.report s23.report s24.report s25.report s26.report s27.report s28.report s29.report s30.report s31.report s32.report s33.report s34.report s35.report s36.report s37.report s38.report s39.report s40.report s41.report s42.report s43.report s44.report s45.report s46.report s47.report s48.report s49.report s50.report s51.report s52.report s53.report s54.report s55.report s56.report s57.report s58.report s59.report s60.report s61.report s62.report s63.report s64.report s65.report s66.report s67.report s68.report s69.report s70.report s71.report s72.report s73.report s74.report s75.report -m metadata.tsv --fmt json -o tree_fruit.biom
```
Error in h(simpleError(msg, call)) : 
  error in evaluating the argument 'object' in selecting a method for function 'otu_table': 'names' attribute [3] must be the same length as the vector [0]
```
```
https://github.com/joey711/phyloseq/issues/349 :

enter command and then import your files into phyloseq again:  

biom convert -i otu_table.biom -o otu_table.txt -b --header-key taxonomy --output-metadata-id "Consensus Lineage"

Before the update, the metadata-id was just "Lineage". For me it did not work to simply change the header in Excel, but after re-running this conversion I was able to import the files smoothly into phyloseq.

https://biom-format.org/documentation/biom_conversion.html

https://biom-format.org/index.html

https://bioconductor.org/packages/release/bioc/html/biomformat.html

https://bioconductor.org/packages/release/bioc/manuals/biomformat/man/biomformat.pdf

https://github.com/joey711/biomformat/
```
***
### kraken-biom attempt - validation error
```
cd /xdisk/kcooper/caparicio/tree-fruit/05kraken-biom_b

module load python

source ~/virtual/biom-format_env/bin/activate

biom validate-table -i tree_fruit.biom

The input file is a valid BIOM-formatted file.

biom convert -i tree_fruit.biom -o tree_fruit.txt --to-tsv --header-key taxonomy --output-metadata-id "Consensus Lineage"

biom convert -i tree_fruit.biom -o tree_fruit.txt --to-tsv

biom convert -i tree_fruit.biom -o tree_fruit.json --to-json
```
json output:
```
{"id":"None","format":"Biological Observation Matrix 1.0.0","format_url":"http://biom-format.org","matrix_type":"sparse","generated_by":"BIOM-Format 2.1.16","date":"2024-07-04T06:08:56.474833","type":"OTU table","matrix_element_type":"int","shape":[0,0],"data":[],"rows":[],"columns":[]}
