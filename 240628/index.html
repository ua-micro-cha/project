
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Raw notes dump">
      
      
        <meta name="author" content="Aparicio">
      
      
        <link rel="canonical" href="https://ua-micro-cha/github.io/project/240628/">
      
      
        <link rel="prev" href="../assets/abricate_run/">
      
      
        <link rel="next" href="../240510/">
      
      
      <link rel="icon" href="../images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.20">
    
    
      
        <title>Update - UA Micro Cha Project</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#28-june-2024" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="UA Micro Cha Project" class="md-header__button md-logo" aria-label="UA Micro Cha Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            UA Micro Cha Project
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Update
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ua-micro-cha/project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    project
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="UA Micro Cha Project" class="md-nav__button md-logo" aria-label="UA Micro Cha Project" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z"/></svg>

    </a>
    UA Micro Cha Project
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ua-micro-cha/project" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    project
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fruit Surface and Soil Microbiome Project
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    15 August 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            15 August 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../240815a.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    26 July 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            26 July 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../240726/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    20 July 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            20 July 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../240720/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    12 July 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            12 July 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../240712/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Jupyter Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Jupyter Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/abricate_install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abricate Install Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/abricate_run/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abricate Run Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    28 June 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            28 June 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Update
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraken-biom-attempt-vector-length-error" class="md-nav__link">
    <span class="md-ellipsis">
      kraken-biom attempt - vector length error
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kraken-biom attempt - vector length error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kraken-biom-attempt-validation-error" class="md-nav__link">
    <span class="md-ellipsis">
      kraken-biom attempt - validation error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-that-will-work-with-the-actual-taxonomy-file-named-taxonomy_filetxt" class="md-nav__link">
    <span class="md-ellipsis">
      Code that will work with the actual taxonomy file named 'taxonomy_file.txt'
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      visualization r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocount-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      pseudocount r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alpha-apple-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      alpha apple r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phyloseq-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      phyloseq r script
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    10 May 2024
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            10 May 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../240510/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Update
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7_2" >
        
          
          <label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Jupyter Notebooks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_7_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7_2">
            <span class="md-nav__icon md-icon"></span>
            Jupyter Notebooks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/apple_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Apple metaSPAdes Assembly Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/orange_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Orange metaSPAdes Assembly Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/peach_assembly/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peach metaSPAdes Assembly Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../assets/tree_fruit_kraken-biom/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tree Fruit kraken-biom Jupyter Notebook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../240426/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    26 April 2024
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kraken-biom-attempt-vector-length-error" class="md-nav__link">
    <span class="md-ellipsis">
      kraken-biom attempt - vector length error
    </span>
  </a>
  
    <nav class="md-nav" aria-label="kraken-biom attempt - vector length error">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kraken-biom-attempt-validation-error" class="md-nav__link">
    <span class="md-ellipsis">
      kraken-biom attempt - validation error
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-that-will-work-with-the-actual-taxonomy-file-named-taxonomy_filetxt" class="md-nav__link">
    <span class="md-ellipsis">
      Code that will work with the actual taxonomy file named 'taxonomy_file.txt'
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visualization-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      visualization r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pseudocount-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      pseudocount r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alpha-apple-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      alpha apple r script
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#phyloseq-r-script" class="md-nav__link">
    <span class="md-ellipsis">
      phyloseq r script
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="28-june-2024">28 June 2024<a class="headerlink" href="#28-june-2024" title="Permanent link">&para;</a></h1>
<h2 id="kraken-biom-attempt-vector-length-error">kraken-biom attempt - vector length error<a class="headerlink" href="#kraken-biom-attempt-vector-length-error" title="Permanent link">&para;</a></h2>
<p><div class="highlight"><pre><span></span><code># create biom from kraken2 reports

cd /xdisk/kcooper/caparicio/tree-fruit/05kraken-biom_b

module load anaconda/2020

source ~/.bashrc

apptainer run https://depot.galaxyproject.org/singularity/kraken-biom:1.2.0--pyh5e36f6f_0

kraken-biom s01.report s02.report s03.report s04.report s05.report s06.report s07.report s08.report s09.report s10.report s11.report s12.report s13.report s14.report s15.report s16.report s17.report s18.report s19.report s20.report s21.report s22.report s23.report s24.report s25.report s26.report s27.report s28.report s29.report s30.report s31.report s32.report s33.report s34.report s35.report s36.report s37.report s38.report s39.report s40.report s41.report s42.report s43.report s44.report s45.report s46.report s47.report s48.report s49.report s50.report s51.report s52.report s53.report s54.report s55.report s56.report s57.report s58.report s59.report s60.report s61.report s62.report s63.report s64.report s65.report s66.report s67.report s68.report s69.report s70.report s71.report s72.report s73.report s74.report s75.report -m metadata.tsv --fmt json -o tree_fruit.biom
</code></pre></div>
Error in h(simpleError(msg, call)) : 
  error in evaluating the argument 'object' in selecting a method for function 'otu_table': 'names' attribute [3] must be the same length as the vector [0]</p>
<hr />
<h3 id="kraken-biom-attempt-validation-error">kraken-biom attempt - validation error<a class="headerlink" href="#kraken-biom-attempt-validation-error" title="Permanent link">&para;</a></h3>
<p><div class="highlight"><pre><span></span><code>cd /xdisk/kcooper/caparicio/tree-fruit/05kraken-biom_b

module load python

source ~/virtual/biom-format_env/bin/activate

biom validate-table -i tree_fruit.biom

The input file is a valid BIOM-formatted file.

biom convert -i tree_fruit.biom -o tree_fruit.txt --to-tsv --header-key taxonomy --output-metadata-id &quot;Consensus Lineage&quot;

biom convert -i tree_fruit.biom -o tree_fruit.txt --to-tsv

biom convert -i tree_fruit.biom -o tree_fruit.json --to-json
</code></pre></div>
json output:
<div class="highlight"><pre><span></span><code>{&quot;id&quot;:&quot;None&quot;,&quot;format&quot;:&quot;Biological Observation Matrix 1.0.0&quot;,&quot;format_url&quot;:&quot;http://biom-format.org&quot;,&quot;matrix_type&quot;:&quot;sparse&quot;,&quot;generated_by&quot;:&quot;BIOM-Format 2.1.16&quot;,&quot;date&quot;:&quot;2024-07-04T06:08:56.474833&quot;,&quot;type&quot;:&quot;OTU table&quot;,&quot;matrix_element_type&quot;:&quot;int&quot;,&quot;shape&quot;:[0,0],&quot;data&quot;:[],&quot;rows&quot;:[],&quot;columns&quot;:[]}
</code></pre></div></p>
<hr />
<h2 id="code-that-will-work-with-the-actual-taxonomy-file-named-taxonomy_filetxt">Code that will work with the actual taxonomy file named 'taxonomy_file.txt'<a class="headerlink" href="#code-that-will-work-with-the-actual-taxonomy-file-named-taxonomy_filetxt" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code># Load taxonomy table from a TXT file, treating it as a TSV
taxonomy_table_path = &quot;taxonomy_file.txt&quot;
taxonomy_table = pd.read_csv(taxonomy_table_path, sep=&#39;\t&#39;, index_col=0)

# Ensure taxa names match between OTU table and taxonomy table
common_taxa = otu_table.index.intersection(taxonomy_table.index)
otu_table = otu_table.loc[common_taxa]
taxonomy_table = taxonomy_table.loc[common_taxa]

# Save the combined OTU table to a TSV file
otu_table_path = &quot;combined_otu_table.tsv&quot;
otu_table.to_csv(otu_table_path, sep=&#39;\t&#39;)

# Save the combined OTU table to a TXT file
otu_table_path_txt = &quot;combined_otu_table.txt&quot;
otu_table.to_csv(otu_table_path_txt, sep=&#39;\t&#39;)

# Save the updated taxonomy table to ensure it matches the OTU table
taxonomy_table_path_updated = &quot;updated_taxonomy_table.tsv&quot;
taxonomy_table.to_csv(taxonomy_table_path_updated, sep=&#39;\t&#39;)

print(f&quot;Combined OTU table saved to {otu_table_path}&quot;)
print(f&quot;Combined OTU table saved to {otu_table_path_txt}&quot;)
print(f&quot;Updated taxonomy table saved to {taxonomy_table_path_updated}&quot;)
</code></pre></div>
<hr />
<h2 id="visualization-r-script">visualization r script<a class="headerlink" href="#visualization-r-script" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">requireNamespace</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">quietly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span>
<span class="w">  </span><span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;BiocManager&quot;</span><span class="p">)</span>
<span class="n">BiocManager</span><span class="o">::</span><span class="nf">install</span><span class="p">(</span><span class="s">&quot;phyloseq&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;ggplot2&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;dplyr&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;RColorBrewer&quot;</span><span class="p">)</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;vegan&quot;</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">phyloseq</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">vegan</span><span class="p">)</span>

<span class="n">otu_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readr</span><span class="o">::</span><span class="nf">read_tsv</span><span class="p">(</span><span class="s">&quot;combined_otu_table.tsv&quot;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">taxpasta_data</span><span class="p">)</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readr</span><span class="o">::</span><span class="nf">read_tsv</span><span class="p">(</span><span class="s">&quot;metadata.tsv&quot;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Save the otu_file as an Rda file</span>
<span class="nf">save</span><span class="p">(</span><span class="n">otu_table</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;otu_table.rda&quot;</span><span class="p">)</span>

<span class="c1"># Set working directory (modify this path as needed)</span>
<span class="nf">setwd</span><span class="p">(</span><span class="s">&quot;path/to/your/working/directory&quot;</span><span class="p">)</span>

<span class="c1"># Load the necessary components</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;otu_table.rda&quot;</span><span class="p">)</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;taxonomy_table.rda&quot;</span><span class="p">)</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;metadata.rda&quot;</span><span class="p">)</span>

<span class="c1"># Check if all necessary objects are loaded</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">exists</span><span class="p">(</span><span class="s">&quot;otu_table&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;The otu_table object was not found in the loaded file.&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">exists</span><span class="p">(</span><span class="s">&quot;taxonomy_table&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;The taxonomy_table object was not found in the loaded file.&quot;</span><span class="p">)</span>
<span class="p">}</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">exists</span><span class="p">(</span><span class="s">&quot;metadata&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;The metadata object was not found in the loaded file.&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Ensure metadata has non-zero dimensions</span>
<span class="nf">if </span><span class="p">(</span><span class="nf">nrow</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="nf">ncol</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;Metadata must have non-zero dimensions.&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Create the OTU table</span>
<span class="n">otu_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">otu_table</span><span class="p">(</span><span class="n">otu_table</span><span class="p">,</span><span class="w"> </span><span class="n">taxa_are_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Create the taxonomy table</span>
<span class="n">taxonomy_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tax_table</span><span class="p">(</span><span class="n">taxonomy_table</span><span class="p">)</span>

<span class="c1"># Convert metadata to sample_data format</span>
<span class="n">sample_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample_data</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Ensure taxa names are consistent across all components</span>
<span class="nf">taxa_names</span><span class="p">(</span><span class="n">otu_table</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">taxonomy_table</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">otu_table</span><span class="p">)</span>
<span class="nf">sample_names</span><span class="p">(</span><span class="n">sample_data</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">colnames</span><span class="p">(</span><span class="n">otu_table</span><span class="p">)</span>

<span class="c1"># Create the phyloseq object</span>
<span class="n">physeq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">phyloseq</span><span class="p">(</span><span class="n">otu_table</span><span class="p">,</span><span class="w"> </span><span class="n">taxonomy_table</span><span class="p">,</span><span class="w"> </span><span class="n">sample_data</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="n">physeq</span><span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">tax_table</span><span class="p">)</span>
<span class="c1"># Check if the phyloseq object has been created properly</span>
<span class="nf">if </span><span class="p">(</span><span class="o">!</span><span class="nf">exists</span><span class="p">(</span><span class="s">&quot;physeq&quot;</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">stop</span><span class="p">(</span><span class="s">&quot;The physeq object was not created successfully.&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1"># Subset the phyloseq object to keep the most abundant taxa</span>
<span class="n">top_taxa</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="nf">sort</span><span class="p">(</span><span class="nf">taxa_sums</span><span class="p">(</span><span class="n">physeq</span><span class="p">),</span><span class="w"> </span><span class="n">decreasing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)[</span><span class="m">1</span><span class="o">:</span><span class="m">50</span><span class="p">])</span>
<span class="n">physeq_top</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">prune_taxa</span><span class="p">(</span><span class="n">top_taxa</span><span class="p">,</span><span class="w"> </span><span class="n">physeq</span><span class="p">)</span>

<span class="c1"># Prepare data for vegan&#39;s rda function</span>
<span class="n">otu_matrix</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as</span><span class="p">(</span><span class="nf">otu_table</span><span class="p">(</span><span class="n">physeq_top</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;matrix&quot;</span><span class="p">)</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">sample_data</span><span class="p">(</span><span class="n">physeq_top</span><span class="p">))</span>

<span class="c1"># Ensure the row names of metadata match the OTU matrix</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metadata</span><span class="p">[</span><span class="nf">rownames</span><span class="p">(</span><span class="n">otu_matrix</span><span class="p">),</span><span class="w"> </span><span class="p">]</span>

<span class="c1"># Convert all relevant columns to factors and remove those with fewer than 2 levels</span>
<span class="nf">for </span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">metadata</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nf">if </span><span class="p">(</span><span class="nf">is.character</span><span class="p">(</span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]]))</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.factor</span><span class="p">(</span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]])</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="nf">if </span><span class="p">(</span><span class="nf">is.factor</span><span class="p">(</span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]])</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">levels</span><span class="p">(</span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]]))</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">metadata</span><span class="p">[[</span><span class="n">col</span><span class="p">]]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NULL</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Ensure there are no columns with fewer than 2 levels</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">metadata</span><span class="p">[,</span><span class="w"> </span><span class="nf">unlist</span><span class="p">(</span><span class="nf">lapply</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">))]</span>

<span class="c1"># Explicitly list the variables in the formula</span>
<span class="n">variables</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">paste</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">metadata</span><span class="p">),</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; + &quot;</span><span class="p">)</span>
<span class="n">formula</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.formula</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;otu_matrix ~&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">variables</span><span class="p">))</span>

<span class="nf">load</span><span class="p">(</span><span class="n">metadata.rda</span><span class="p">)</span>
<span class="c1"># Perform RDA ordination</span>
<span class="n">ordination</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">vegan</span><span class="o">::</span><span class="nf">rda</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Extract scores for plotting</span>
<span class="n">ordination_scores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">scores</span><span class="p">(</span><span class="n">ordination</span><span class="p">,</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;sites&quot;</span><span class="p">)</span>
<span class="n">ordination_scores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.data.frame</span><span class="p">(</span><span class="n">ordination_scores</span><span class="p">)</span>
<span class="n">ordination_scores</span><span class="o">$</span><span class="n">Sample</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rownames</span><span class="p">(</span><span class="n">ordination_scores</span><span class="p">)</span>

<span class="c1"># Merge with metadata for plotting</span>
<span class="n">ordination_scores</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">merge</span><span class="p">(</span><span class="n">ordination_scores</span><span class="p">,</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">by.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">by.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;row.names&quot;</span><span class="p">)</span>

<span class="c1"># Generate a color palette using RColorBrewer</span>
<span class="n">palette</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">brewer.pal</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">ordination_scores</span><span class="o">$</span><span class="n">fruit</span><span class="p">)),</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set3&quot;</span><span class="p">)</span>

<span class="c1"># Create tabasco plot using ggplot2</span>
<span class="n">tabasco_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">ordination_scores</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RDA1</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RDA2</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fruit</span><span class="p">,</span><span class="w"> </span><span class="n">shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Site</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Ordination of Most Abundant Taxa on Fruit&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palette</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span>
<span class="w">    </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize x-axis title font size</span>
<span class="w">    </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize y-axis title font size</span>
<span class="w">    </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span><span class="w">   </span><span class="c1"># Customize x-axis label font size</span>
<span class="w">    </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span><span class="w">   </span><span class="c1"># Customize y-axis label font size</span>
<span class="w">    </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">),</span><span class="w">  </span><span class="c1"># Center and customize title font size</span>
<span class="w">    </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize legend title font size</span>
<span class="w">    </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">    </span><span class="c1"># Customize legend text font size</span>
<span class="w">  </span><span class="p">)</span>

<span class="c1"># Print tabasco plot</span>
<span class="nf">print</span><span class="p">(</span><span class="n">tabasco_plot</span><span class="p">)</span>

<span class="c1"># Save tabasco plot</span>
<span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;ordination_plot.png&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tabasco_plot</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="pseudocount-r-script">pseudocount r script<a class="headerlink" href="#pseudocount-r-script" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Verify the working directory</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">getwd</span><span class="p">())</span>

<span class="c1"># List files in the working directory</span>
<span class="n">files</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list.files</span><span class="p">(</span><span class="nf">getwd</span><span class="p">())</span>
<span class="nf">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>

<span class="c1"># Load your phyloseq object</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;phyloseq.Rda&quot;</span><span class="p">)</span>

<span class="c1"># Apply log transformation with a pseudocount</span>
<span class="n">log_transformed_physeq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">transform_sample_counts</span><span class="p">(</span><span class="n">physeq</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">log10</span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">))</span>

<span class="c1"># Save the transformed phyloseq object in the new project directory</span>
<span class="nf">save</span><span class="p">(</span><span class="n">log_transformed_physeq</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;log_transformed_physeq.Rda&quot;</span><span class="p">)</span>

<span class="c1"># Verify the transformation</span>
<span class="nf">print</span><span class="p">(</span><span class="n">log_transformed_physeq</span><span class="p">)</span>


<span class="c1"># Filter out low-abundance taxa</span>
<span class="c1"># filtered_physeq &lt;- filter_taxa(log_transformed_physeq, function(x) mean(x) &gt; 1e-5, TRUE)</span>
<span class="c1"># Warning message:</span>
<span class="c1">#  In estimate_richness(filtered_physeq, measures = c(&quot;Shannon&quot;, &quot;Simpson&quot;)) :</span>
<span class="c1">#  The data you have provided does not have</span>
<span class="c1"># any singletons. This is highly suspicious. Results of richness</span>
<span class="c1"># estimates (for example) are probably unreliable, or wrong, if you have  already</span>
<span class="c1"># trimmed low-abundance taxa from the data.</span>

<span class="c1"># We recommended that you find the un-trimmed data and retry.</span>

<span class="c1"># &gt; print(filtered_physeq)</span>
<span class="c1"># phyloseq-class experiment-level object</span>
<span class="c1"># otu_table()   OTU Table:         [ 38490 taxa and 75 samples ]</span>
<span class="c1"># sample_data() Sample Data:       [ 75 samples by 9 sample variables ]</span>



<span class="c1"># Filter out low-abundance taxa with a less stringent threshold</span>
<span class="n">filtered_physeq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">filter_taxa</span><span class="p">(</span><span class="n">log_transformed_physeq</span><span class="p">,</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1e-6</span><span class="p">,</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="c1"># Check the filtered data</span>
<span class="nf">print</span><span class="p">(</span><span class="n">filtered_physeq</span><span class="p">)</span>

<span class="c1"># phyloseq-class experiment-level object</span>
<span class="c1"># otu_table()   OTU Table:         [ 39985 taxa and 75 samples ]</span>
<span class="c1"># sample_data() Sample Data:       [ 75 samples by 9 sample variables ]</span>

<span class="c1"># Perform alpha diversity analysis on the untrimmed data</span>
<span class="n">alpha_div_untrimmed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">estimate_richness</span><span class="p">(</span><span class="n">physeq</span><span class="p">,</span><span class="w"> </span><span class="n">measures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;Shannon&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Simpson&quot;</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="n">alpha_div_untrimmed</span><span class="p">)</span>

<span class="c1"># Save alpha diversity results</span>
<span class="nf">write.csv</span><span class="p">(</span><span class="n">alpha_div_untrimmed</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;alpha_diversity_untrimmed_results.csv&quot;</span><span class="p">)</span>


<span class="c1"># Beta Diversity Analysis with filtered data</span>
<span class="n">ord</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ordinate</span><span class="p">(</span><span class="n">filtered_physeq</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PCoA&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">distance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;bray&quot;</span><span class="p">)</span>
<span class="nf">plot_ordination</span><span class="p">(</span><span class="n">filtered_physeq</span><span class="p">,</span><span class="w"> </span><span class="n">ord</span><span class="p">,</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SampleType&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Beta Diversity (PCoA) based on Bray-Curtis distance&quot;</span><span class="p">)</span>

<span class="c1"># Save beta diversity plot</span>
<span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;beta_diversity_filtered_plot.png&quot;</span><span class="p">)</span>
</code></pre></div>
<h2 id="alpha-apple-r-script">alpha apple r script<a class="headerlink" href="#alpha-apple-r-script" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Install and load necessary libraries</span>
<span class="nf">install.packages</span><span class="p">(</span><span class="s">&quot;RColorBrewer&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">phyloseq</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span>

<span class="c1"># Set working directory</span>

<span class="c1"># Load the untrimmed phyloseq object</span>
<span class="nf">load</span><span class="p">(</span><span class="s">&quot;physeq.Rda&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Shannon diversity</span>
<span class="n">shannon_div</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">estimate_richness</span><span class="p">(</span><span class="n">physeq</span><span class="p">,</span><span class="w"> </span><span class="n">measures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Shannon&quot;</span><span class="p">)</span>

<span class="c1"># Merge with metadata</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">data.frame</span><span class="p">(</span><span class="nf">sample_data</span><span class="p">(</span><span class="n">physeq</span><span class="p">))</span>
<span class="n">shannon_div</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">shannon_div</span><span class="p">)</span>

<span class="c1"># Filter for apples</span>
<span class="n">apples_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">shannon_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">fruit</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;apple&quot;</span><span class="p">)</span>

<span class="c1"># Generate a color palette using RColorBrewer</span>
<span class="n">palette</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">brewer.pal</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="nf">unique</span><span class="p">(</span><span class="n">apples_data</span><span class="o">$</span><span class="n">site</span><span class="p">)),</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Set3&quot;</span><span class="p">)</span>

<span class="c1"># Create boxplot for apples by growing site</span>
<span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">ggplot</span><span class="p">(</span><span class="n">apples_data</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Shannon</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">site</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_boxplot</span><span class="p">(</span>
<span class="w">    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">,</span><span class="w">  </span><span class="c1"># Set the box border color to black</span>
<span class="w">    </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">,</span><span class="w">       </span><span class="c1"># Border line width</span>
<span class="w">    </span><span class="n">outlier.shape</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="w">  </span><span class="c1"># Remove outliers</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme_minimal</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Shannon Diversity of Apples by Growing Site&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">scale_fill_manual</span><span class="p">(</span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">palette</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span>
<span class="w">    </span><span class="n">axis.title.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize x-axis title font size</span>
<span class="w">    </span><span class="n">axis.title.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize y-axis title font size</span>
<span class="w">    </span><span class="n">axis.text.x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span><span class="w">   </span><span class="c1"># Customize x-axis label font size</span>
<span class="w">    </span><span class="n">axis.text.y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">14</span><span class="p">),</span><span class="w">   </span><span class="c1"># Customize y-axis label font size</span>
<span class="w">    </span><span class="n">plot.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">18</span><span class="p">),</span><span class="w">  </span><span class="c1"># Center and customize title font size</span>
<span class="w">    </span><span class="n">legend.title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">),</span><span class="w">  </span><span class="c1"># Customize legend title font size</span>
<span class="w">    </span><span class="n">legend.text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_text</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">15</span><span class="p">)</span><span class="w">    </span><span class="c1"># Customize legend text font size</span>
<span class="w">  </span><span class="p">)</span>

<span class="c1"># Print plot</span>
<span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Save plot</span>
<span class="nf">ggsave</span><span class="p">(</span><span class="s">&quot;shannon_diversity_apples_by_site.png&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">plot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6</span><span class="p">)</span>


<span class="c1"># Perform ANOVA to test for significant differences in Shannon diversity between growing sites for apples</span>
<span class="n">anova_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">aov</span><span class="p">(</span><span class="n">Shannon</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">site</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apples_data</span><span class="p">)</span>
<span class="n">anova_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">anova_result</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">anova_summary</span><span class="p">)</span>

<span class="c1"># Post-hoc test to identify which groups are significantly different</span>
<span class="n">posthoc_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">TukeyHSD</span><span class="p">(</span><span class="n">anova_result</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">posthoc_result</span><span class="p">)</span>

<span class="c1"># Extract p-values from the ANOVA summary</span>
<span class="n">p_value</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">anova_summary</span><span class="p">[[</span><span class="m">1</span><span class="p">]][[</span><span class="s">&quot;Pr(&gt;F)&quot;</span><span class="p">]][</span><span class="m">1</span><span class="p">]</span>
<span class="n">p_value_decimal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="n">p_value</span><span class="p">,</span><span class="w"> </span><span class="n">scientific</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;p-value: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">p_value_decimal</span><span class="p">))</span>

<span class="c1"># Fit a linear model to calculate R-squared</span>
<span class="n">lm_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">Shannon</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">site</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">apples_data</span><span class="p">)</span>
<span class="n">lm_summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">lm_model</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">lm_summary</span><span class="p">)</span>

<span class="c1"># Extract R-squared value</span>
<span class="n">r_squared</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm_summary</span><span class="o">$</span><span class="n">r.squared</span>
<span class="n">r_squared_decimal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">format</span><span class="p">(</span><span class="n">r_squared</span><span class="p">,</span><span class="w"> </span><span class="n">scientific</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">paste</span><span class="p">(</span><span class="s">&quot;R-squared: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">r_squared_decimal</span><span class="p">))</span>
</code></pre></div>
<h2 id="phyloseq-r-script">phyloseq r script<a class="headerlink" href="#phyloseq-r-script" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Load the OTU table</span>
<span class="n">otu_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;combined_otu_table.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Load the taxonomy table</span>
<span class="n">taxonomy_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;updated_taxonomy_table.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Load the sample data (metadata)</span>
<span class="n">metadata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;metadata.tsv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s">&#39;\t&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">row.names</span><span class="o">=</span><span class="m">1</span><span class="p">)</span>

<span class="c1"># Create phyloseq components</span>
<span class="n">otu_table_phy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">otu_table</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">otu_table</span><span class="p">),</span><span class="w"> </span><span class="n">taxa_are_rows</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>

<span class="n">taxonomy_table_phy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tax_table</span><span class="p">(</span><span class="nf">as.matrix</span><span class="p">(</span><span class="n">taxonomy_table</span><span class="p">))</span>

<span class="n">sample_data_phy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sample_data</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>

<span class="c1"># Create the phyloseq object</span>
<span class="n">physeq</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">phyloseq</span><span class="p">(</span><span class="n">otu_table_phy</span><span class="p">,</span><span class="w"> </span><span class="n">taxonomy_table_phy</span><span class="p">,</span><span class="w"> </span><span class="n">sample_data_phy</span><span class="p">)</span>

<span class="c1"># Verify the phyloseq object</span>
<span class="nf">print</span><span class="p">(</span><span class="n">physeq</span><span class="p">)</span>

<span class="nf">save.image</span><span class="p">(</span><span class="s">&quot;phyloseq_workspace01.RData&quot;</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright  2024
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.path", "navigation.indexes", "navigation.top", "toc.follow", "search.suggest", "search.highlight", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dd8806f2.min.js"></script>
      
        <script src="https://unpkg.com/tablesort@5.3.0/dist/tablesort.min.js"></script>
      
        <script src="../javascripts/tablesort.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>